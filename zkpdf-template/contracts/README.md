# GST Verification Smart Contract

On-chain verification of GST certificates using zero-knowledge proofs.

## Overview

The `GSTVerifier` contract verifies GST certificate proofs generated by the SP1 zkVM. It checks document integrity and signature validity without exposing sensitive data.

## Features

- Verify GST certificate proofs on-chain
- Store verification results for future reference
- Check document and public key verification status
- Emit events for verified certificates

## Testing

Run the test suite:

```bash
forge test -v
```

## Contract Functions

### `verifyGSTProof(publicValues, proofBytes)`

Verifies a proof without storing the result. Returns GST details.

### `verifyAndStoreGST(publicValues, proofBytes)`

Verifies a proof and stores the result. Emits verification event.

### `isDocumentVerified(documentCommitment)`

Checks if a document has been verified.

### `isPublicKeyVerified(publicKeyHash)`

Checks if a public key has been verified.

## Deployment

### 1. Get Verifier Address

Find the SP1 verifier address for your chain from the [deployments list](https://github.com/succinctlabs/sp1-contracts/tree/main/contracts/deployments).

### 2. Get Program Verification Key

```bash
cd ../script
cargo run --bin vkey --release
```

### 3. Deploy Contract

```bash
forge create src/GSTVerifier.sol:GSTVerifier \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --constructor-args $VERIFIER_ADDRESS $PROGRAM_VKEY
```

## Environment Variables

- `VERIFIER` - SP1 verifier contract address
- `PROGRAM_VKEY` - Your program's verification key
- `RPC_URL` - Ethereum RPC endpoint
- `PRIVATE_KEY` - Deployment private key
- `ETHERSCAN_API_KEY` - For contract verification (optional)

## Usage Example

```solidity
// Verify a GST certificate proof
(bool valid, string memory gstNumber, string memory legalName) =
    gstVerifier.verifyGSTProof(publicValues, proofBytes);

// Store verification result
gstVerifier.verifyAndStoreGST(publicValues, proofBytes);

// Check if document is verified
bool isVerified = gstVerifier.isDocumentVerified(documentCommitment);
```
